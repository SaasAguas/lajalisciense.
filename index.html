<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>La Jalisciense Pro</title>

    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="1771074901862.png">
    <link rel="shortcut icon" type="image/png" href="1771074901862.png">
    <link rel="apple-touch-icon" href="1771074901862.png">
    
    <meta name="theme-color" content="#6A1B9A">
    <style>
        /* --- TEMA LAVANDA --- */
        :root {
            --primary: #6A1B9A; 
            --primary-light: #AB47BC;
            --accent: #00E676;
            --bg: #F3E5F5;
            --text: #2c2c2c;
            --card-bg: #FFFFFF;
            --danger: #FF5252;
            --warning: #FFC107;
        }

        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            margin: 0; background-color: var(--bg); color: var(--text); padding-bottom: 90px; 
            overscroll-behavior-y: none;
        }
        
        /* NAVEGACI√ìN (AHORA 4 BOTONES) */
        nav { 
            position: fixed; bottom: 0; width: 100%; 
            background: var(--card-bg); display: flex; justify-content: space-around; 
            padding: 10px 0; border-top: 1px solid #eee; z-index: 1000; 
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05); 
        }
        .nav-btn { 
            background: none; border: none; font-size: 0.75rem; 
            display: flex; flex-direction: column; align-items: center; 
            color: #999; width: 25%; /* Ajustado para 4 opciones */
        }
        .nav-btn.hidden-role { display: none !important; }
        .nav-btn.active { color: var(--primary); font-weight: bold; }
        .nav-icon { font-size: 1.4rem; margin-bottom: 2px; }

        /* PANTALLAS */
        .screen { display: none; padding: 15px; animation: fadeIn 0.3s; }
        .active-screen { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* CARDS & GENERAL */
        .card { 
            background: var(--card-bg); padding: 15px; border-radius: 15px; 
            box-shadow: 0 4px 6px rgba(106, 27, 154, 0.05); margin-bottom: 15px; 
        }
        h2 { margin-top: 0; color: var(--primary); font-size: 1.3rem; }
        
        /* BOTONES */
        .btn { width: 100%; padding: 12px; border: none; border-radius: 10px; font-weight: bold; font-size: 1rem; color: white; margin-top: 10px; cursor: pointer; }
        .btn-primary { background: var(--primary); }
        .btn-success { background: var(--accent); color: #004d25; }
        .btn-danger { background: var(--danger); }
        .btn-sm { background: #E1BEE7; color: var(--primary); border: none; padding: 6px 14px; border-radius: 20px; font-weight: bold; font-size: 0.85rem; cursor: pointer; }

        /* FILTROS */
        .filter-container { display: flex; gap: 8px; margin-bottom: 15px; }
        .filter-btn { flex: 1; padding: 10px 2px; border: none; border-radius: 12px; background-color: #E1BEE7; color: #4A148C; font-weight: bold; font-size: 0.85rem; cursor: pointer; transition: all 0.2s; }
        .filter-btn.active { background-color: var(--primary); color: white; transform: scale(1.05); box-shadow: 0 3px 6px rgba(106, 27, 154, 0.3); }

        /* GRID POS */
        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .flavor-card { background: white; padding: 15px 10px; border-radius: 12px; text-align: center; border: 1px solid #eee; position: relative; }
        .flavor-card:active { background-color: #E1BEE7; border-color: var(--primary); transform: scale(0.98); }
        .stock-badge { font-size: 0.85rem; background: #f3e5f5; color: var(--primary); padding: 2px 8px; border-radius: 8px; display: inline-block; margin-top: 5px; font-weight: bold; }
        
        /* CARRO & VARIOS */
        .cart-bar { position: fixed; bottom: 75px; left: 15px; right: 15px; background: var(--primary); color: white; padding: 15px; border-radius: 50px; display: none; justify-content: space-between; align-items: center; box-shadow: 0 4px 15px rgba(106, 27, 154, 0.4); z-index: 900; animation: slideUp 0.3s; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .qty-selector { display: flex; align-items: center; justify-content: space-between; margin: 15px 0; background: #f3e5f5; border-radius: 10px; padding: 5px; }
        .qty-btn { width: 45px; height: 45px; border: none; background: white; border-radius: 8px; font-size: 1.2rem; font-weight: bold; color: var(--primary); }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .stat-item { background: rgba(255,255,255,0.15); padding: 10px; border-radius: 10px; font-size: 0.85rem; }
        .stat-val { display: block; font-size: 1.2rem; font-weight: bold; margin-top: 5px; }

        /* LISTAS Y TABLAS */
        .cart-list-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; }
        .delete-btn { background: var(--danger); color: white; border: none; border-radius: 8px; width: 35px; height: 35px; font-weight: bold; font-size: 1.2rem; margin-left: 10px; }

        /* BARRAS DE INVENTARIO */
        .inv-row { display: flex; flex-direction: column; padding: 10px 0; border-bottom: 1px solid #eee; }
        .inv-info { display: flex; justify-content: space-between; margin-bottom: 5px; font-weight: bold; font-size: 0.9rem; }
        .progress-bg { width: 100%; background: #f3e5f5; height: 8px; border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; border-radius: 5px; transition: width 0.3s; }

        /* HISTORIAL MEJORADO */
        .history-card { border: 1px solid #eee; border-radius: 10px; padding: 12px; margin-bottom: 10px; background: #fafafa; }
        .hist-header { display: flex; justify-content: space-between; font-size: 0.8rem; color: #666; margin-bottom: 5px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .hist-badge { font-weight: bold; padding: 2px 6px; border-radius: 5px; font-size: 0.75rem; color: white; }
        .badge-venta { background: var(--primary-light); }
        .badge-prod { background: var(--accent); color: #004d25; }
        .badge-corte { background: #FF9800; }
        .hist-cut-group { margin-top: 15px; border: 2px solid var(--primary-light); border-radius: 10px; padding: 10px; background: white; }
        .hist-cut-title { font-weight: bold; color: var(--primary); font-size: 1.1rem; margin-bottom: 10px; display: flex; justify-content: space-between; }

        /* LOGIN / REGISTRO */
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--primary); z-index: 5000; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow-y:auto; padding: 20px 0; }
        .login-box { background: white; padding: 30px; border-radius: 20px; width: 80%; max-width: 350px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); margin: auto; }
        .login-input { width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #E1BEE7; border-radius: 10px; box-sizing: border-box; font-size: 1rem; }
        .logout-btn { background: none; border:none; font-size: 1.5rem; cursor: pointer; padding: 0; }
        .logo-anim { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .link-text { color: var(--primary-light); font-size: 0.9rem; text-decoration: underline; cursor: pointer; margin-top: 15px; display: inline-block; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div class="login-box" id="view-login">
            <img src="1771074901862.png" alt="Logo" style="width: 120px; margin-bottom: 10px;" class="logo-anim">
            <h2 style="color:var(--primary); margin:0 0 10px 0;">Bienvenido</h2>
            <p style="color:#666; margin-top:0;">Sistema de Gesti√≥n</p>
            
            <input type="text" id="login-user" class="login-input" placeholder="Usuario">
            <input type="password" id="login-pass" class="login-input" placeholder="Contrase√±a">
            
            <button class="btn btn-primary" onclick="attemptLogin()">Entrar</button>
            <p id="login-error" style="color:red; display:none; margin-top:10px; font-size:0.9rem;">Datos incorrectos</p>
            
            <span class="link-text" onclick="toggleAuthView('register')">¬øNo tienes cuenta? Reg√≠strate aqu√≠</span>
        </div>

        <div class="login-box" id="view-register" style="display: none;">
            <h2 style="color:var(--primary); margin:0 0 10px 0;">Registro de Personal</h2>
            <p style="color:#666; margin-top:0; font-size:0.9rem;">Requiere c√≥digo de creador</p>
            
            <input type="text" id="reg-user" class="login-input" placeholder="Nuevo Usuario">
            <input type="password" id="reg-pass" class="login-input" placeholder="Contrase√±a">
            
            <select id="reg-role" class="login-input">
                <option value="empleado">Emplead@</option>
                <option value="coo">COO</option>
                <option value="ceo">CEO</option>
            </select>

            <input type="password" id="reg-code" class="login-input" placeholder="C√≥digo de Aprobaci√≥n" style="border-color:var(--warning);">
            
            <button class="btn btn-success" onclick="attemptRegister()">Crear Cuenta</button>
            <span class="link-text" onclick="toggleAuthView('login')">Volver al Inicio de Sesi√≥n</span>
        </div>
        <p style="color:rgba(255,255,255,0.7); margin-top:20px; font-size:0.8rem;">La Jalisciense App Corporativa v4.0</p>
    </div>

    <div style="background: var(--primary); color: white; padding: 10px 15px; position: sticky; top:0; z-index: 900; display:flex; justify-content:space-between; align-items:center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <div style="display:flex; align-items:center; gap:10px;">
            <img src="1771074901862.png" style="width:30px; height:30px; border-radius:50%; background:white; padding:2px;">
            <div style="display:flex; flex-direction:column;">
                <span style="font-weight:bold; font-size:0.9rem;" id="user-display">Invitado</span>
                <span style="font-size:0.7rem; opacity:0.8;" id="role-display">Rol</span>
            </div>
        </div>
        <button class="logout-btn" onclick="openSettings()">‚öôÔ∏è</button>
    </div>
    
    <div id="screen-pos" class="screen active-screen">
        <div class="card">
            <div class="filter-container">
                <button class="filter-btn active" onclick="setFilter('fruta', this)">Fruta üçì</button>
                <button class="filter-btn" onclick="setFilter('crema', this)">Crema ü•õ</button>
                <button class="filter-btn" onclick="setFilter('paleta', this)">Paletas üç®</button>
            </div>
            
            <div id="price-container" style="background:#f9f9f9; padding:10px; border-radius:10px; margin-bottom:15px;">
                <label style="font-size:0.9rem; color:#666; font-weight:bold;">Tipo de Cliente (Agua):</label>
                <select id="price-select" style="width:100%; padding:10px; margin-top:5px; border:1px solid #ddd; border-radius:8px; font-weight:bold; color:var(--primary);">
                    <option value="20" data-tipo="Menudeo">Menudeo ($20 x L)</option>
                    <option value="16" data-tipo="Mayoreo">Mayoreo ($16 x L)</option>
                    <option value="15" data-tipo="Especial">Especial ($15 x L)</option>
                </select>
            </div>
            
            <div id="fixed-price-msg" style="display:none; background:#E1BEE7; color:#4A148C; padding:10px; border-radius:10px; margin-bottom:15px; text-align:center; font-weight:bold;">
                Precios Fijos seg√∫n producto
            </div>

            <div class="grid" id="flavors-grid"></div>
        </div>
    </div>

    <div id="cart-bar" class="cart-bar" onclick="showCheckout()">
        <span id="cart-count" style="background:white; color:var(--primary); padding:2px 8px; border-radius:10px; font-weight:bold;">0</span>
        <strong id="cart-total" style="font-size:1.1rem;">$0</strong>
        <span style="font-weight:bold;">Ver Carrito üõí</span>
    </div>

    <div id="screen-prod" class="screen">
        <div class="card">
            <h2 style="margin-bottom: 15px;">üè≠ Producci√≥n</h2>
            <div class="filter-container">
                <button id="btn-prod-fruta" class="filter-btn active" onclick="setProdMode('fruta')">Fruta üçì</button>
                <button id="btn-prod-crema" class="filter-btn" onclick="setProdMode('crema')">Crema ü•õ</button>
                <button id="btn-prod-paleta" class="filter-btn" onclick="setProdMode('paleta')">Paletas üç≠</button>
            </div>

            <p style="font-size:0.9rem; color:#666; text-align:center;" id="prod-subtitle">Registrar producci√≥n de Fruta</p>
            
            <label style="font-weight:bold; color:var(--primary);">Producto:</label>
            <select id="prod-flavor" style="width:100%; padding:12px; margin:10px 0; border:1px solid #ddd; border-radius:10px; background:white;"></select>
            
            <label style="font-weight:bold; color:var(--primary);">Cantidad a registrar:</label>
            <div class="qty-selector">
                <button class="qty-btn" onclick="adjustProd(-5)">-5</button>
                <input type="number" id="prod-qty" value="20" style="border:none; background:transparent; text-align:center; font-size:1.5rem; width:60px; font-weight:bold;">
                <button class="qty-btn" onclick="adjustProd(5)">+5</button>
            </div>

            <button class="btn btn-primary" onclick="saveProduction()">Guardar Producci√≥n</button>
        </div>
    </div>

    <div id="screen-admin" class="screen">
        <div class="card" style="text-align:center; background: linear-gradient(135deg, var(--primary), #8E24AA); color: white;">
            <h2 style="color:white; border-bottom-color: rgba(255,255,255,0.2);">Caja del Turno</h2>
            <h1 id="stat-cash" style="font-size:3rem; margin:10px 0;">$0</h1>
            
            <div class="stats-grid">
                <div class="stat-item">
                    <span>Ventas (Aguas)</span>
                    <span class="stat-val" id="stat-sold-l">0 L</span>
                </div>
                <div class="stat-item">
                    <span>Ventas (Paletas)</span>
                    <span class="stat-val" id="stat-sold-p">0 Pz</span>
                </div>
                <div class="stat-item">
                    <span>Fab. (Aguas)</span>
                    <span class="stat-val" id="stat-prod-l">0 L</span>
                </div>
                <div class="stat-item">
                    <span>Relleno (Palet)</span>
                    <span class="stat-val" id="stat-prod-p">0 Pz</span>
                </div>
            </div>

            <button id="btn-corte" class="btn hidden-role" style="background:rgba(255,255,255,0.2); color:white; margin-top:15px;" onclick="closeDay()">üîí Cerrar Turno (Corte de Caja)</button>
        </div>

        <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:2px solid #f3e5f5; padding-bottom:10px; margin-bottom:10px;">
                <h2 style="margin:0; border:none; font-size:1.1rem;" id="inv-title">Inventario</h2>
                <button class="btn-sm" onclick="toggleInvView()">üîÑ Cambiar</button>
            </div>
            
            <div style="max-height:400px; overflow-y:auto;" id="inv-container"></div>
        </div>
    </div>

        <div id="screen-historial" class="screen">
        <div class="card">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h2 style="margin:0;">üìù Turno Actual</h2>
                <div style="display:flex; gap:5px;">
                    <button onclick="downloadExcel()" class="btn-sm" style="background:var(--accent); color:#004d25; margin:0;">‚¨á Excel</button>
                    <button id="btn-clear-hist" onclick="clearHistory()" class="btn-sm hidden-role" style="background:var(--danger); color:white; margin:0;">üóë Borrar</button>
                </div>
            </div>
            
            <div style="max-height:250px; overflow-y:auto; margin-bottom: 20px;" id="hist-current-container">
                </div>

            <h2 style="margin-top:20px; border-top: 1px solid #eee; padding-top:15px;">üìÅ Cortes Hist√≥ricos</h2>
            <div id="hist-cuts-container" style="max-height:300px; overflow-y:auto; padding-right:5px;">
                </div>
        </div>
    </div>

    <div id="checkout-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:2000; align-items:center; justify-content:center;">
        <div style="background:white; width:90%; max-width:400px; padding:25px; border-radius:15px; box-shadow:0 10px 25px rgba(0,0,0,0.2);">
            <h3 style="margin-top:0; color:var(--primary);">üõí Confirmar Venta</h3>
            <div id="checkout-list" style="max-height: 250px; overflow-y: auto; margin-bottom:20px;"></div>
            <div style="text-align:right; font-size:1.5rem; font-weight:bold; margin-bottom:20px; border-top:1px solid #eee; padding-top:10px;" id="checkout-total">Total: $0</div>
            <div style="display:flex; gap:10px;">
                <button class="btn btn-danger" style="margin:0;" onclick="document.getElementById('checkout-modal').style.display='none'">Cerrar</button>
                <button class="btn btn-success" style="margin:0;" onclick="finishSale()">Cobrar</button>
            </div>
        </div>
    </div>

    <div id="settings-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:3000; align-items:center; justify-content:center;">
        <div style="background:white; width:90%; max-width:400px; padding:25px; border-radius:15px; text-align:center; position:relative;">
            <button onclick="closeSettings()" style="position:absolute; top:10px; right:15px; background:none; border:none; font-size:1.5rem; color:var(--danger); cursor:pointer;">‚úï</button>
            <h2 style="margin-top:0;">Ajustes ‚öôÔ∏è</h2>
            
            <button id="btn-set-flav" class="btn btn-primary hidden-role" onclick="showAddFlavor()">Agregar Sabores üçì</button>
            <button id="btn-set-pal" class="btn btn-primary hidden-role" style="background:var(--primary-light);" onclick="showAddPaleta()">Agregar Paletas üç≠</button>
            <button id="btn-set-edit" class="btn btn-success hidden-role" style="background:#BA68C8; color:white;" onclick="showEditFlavors()">Editar Inventario ‚úèÔ∏è</button>
            
            <button class="btn btn-danger" style="margin-top:25px;" onclick="doLogout(); closeSettings();">Cerrar Sesi√≥n üö™</button>
        </div>
    </div>

    <div id="add-flavor-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:3100; align-items:center; justify-content:center;">
        <div style="background:white; width:90%; max-width:400px; padding:25px; border-radius:15px;">
            <h3 style="color:var(--primary); margin-top:0;">Nuevo Sabor (Agua)</h3>
            <input type="text" id="new-flavor-name" class="login-input" placeholder="Nombre del sabor">
            <select id="new-flavor-type" class="login-input">
                <option value="fruta">Fruta üçì</option>
                <option value="crema">Crema ü•õ</option>
            </select>
            <input type="number" id="new-flavor-stock" class="login-input" placeholder="Stock inicial (Litros)" min="0">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-danger" style="margin:0;" onclick="document.getElementById('add-flavor-modal').style.display='none'">Cancelar</button>
                <button class="btn btn-success" style="margin:0;" onclick="saveNewFlavor()">Guardar</button>
            </div>
        </div>
    </div>

    <div id="add-paleta-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:3100; align-items:center; justify-content:center;">
        <div style="background:white; width:90%; max-width:400px; padding:25px; border-radius:15px;">
            <h3 style="color:var(--primary); margin-top:0;">Nueva Paleta</h3>
            <input type="text" id="new-paleta-name" class="login-input" placeholder="Nombre de la paleta">
            <input type="number" id="new-paleta-price" class="login-input" placeholder="Precio Fijo ($)" min="0">
            <input type="number" id="new-paleta-stock" class="login-input" placeholder="Stock inicial (Piezas)" min="0">
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn btn-danger" style="margin:0;" onclick="document.getElementById('add-paleta-modal').style.display='none'">Cancelar</button>
                <button class="btn btn-success" style="margin:0;" onclick="saveNewPaleta()">Guardar</button>
            </div>
        </div>
    </div>

    <div id="edit-flavors-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:3100; align-items:center; justify-content:center;">
        <div style="background:white; width:95%; max-width:500px; padding:20px; border-radius:15px; max-height:90vh; display:flex; flex-direction:column;">
            <h3 style="color:var(--primary); margin-top:0;">Editar Inventario ‚úèÔ∏è</h3>
            <p style="font-size:0.8rem; color:#666; margin-top:0;">Modifica los campos y presiona üíæ para guardar, o üóëÔ∏è para borrar.</p>
            <div id="edit-list-container" style="overflow-y:auto; flex:1; margin-bottom:15px;"></div>
            <button class="btn btn-danger" onclick="document.getElementById('edit-flavors-modal').style.display='none'">Cerrar Panel</button>
        </div>
    </div>

    <div id="cut-detail-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:4000; align-items:center; justify-content:center;">
        <div style="background:white; width:95%; max-width:500px; padding:20px; border-radius:15px; max-height:90vh; display:flex; flex-direction:column;">
            <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:2px solid var(--primary); padding-bottom:10px; margin-bottom:10px;">
                <h3 id="cut-detail-title" style="color:var(--primary); margin:0;">Detalle de Corte</h3>
                <button onclick="document.getElementById('cut-detail-modal').style.display='none'" style="background:none; border:none; font-size:1.5rem; color:var(--danger); cursor:pointer;">‚úï</button>
            </div>
            
            <div id="cut-detail-stats" style="background:#f3e5f5; padding:10px; border-radius:10px; margin-bottom:15px; font-size:0.9rem;">
                </div>
            
            <strong style="color:var(--primary); margin-bottom:5px;">Movimientos del Turno:</strong>
            <div id="cut-detail-list" style="overflow-y:auto; flex:1; margin-bottom:15px; font-size:0.85rem; border:1px solid #eee; border-radius:8px; padding:10px;">
                </div>
            
            <button class="btn btn-primary" onclick="document.getElementById('cut-detail-modal').style.display='none'">Cerrar Detalles</button>
        </div>
    </div>

    <nav>
        <button id="nav-pos" class="nav-btn active" onclick="go('pos', this)">
            <span class="nav-icon">üè™</span>Venta
        </button>
        <button id="nav-prod" class="nav-btn" onclick="go('prod', this)">
            <span class="nav-icon">üè≠</span>Prod.
        </button>
        <button id="nav-admin" class="nav-btn" onclick="go('admin', this)">
            <span class="nav-icon">üìä</span>Admin
        </button>
        <button id="nav-historial" class="nav-btn" onclick="go('historial', this)">
            <span class="nav-icon">üßæ</span>Historial
        </button>
    </nav>

        <script>
        // --- C√ìDIGO DE CREADOR ---
        const CREATOR_CODE = "08020824";

        // --- BASE DE DATOS (V9.0 - Usuarios Din√°micos e Historial Profundo) ---
        const DB_KEY = 'jalisciense_corp_v9.0'; 
        
        const defaultFlavors = [
            {n:'Jamaica', t:'fruta', s:20}, {n:'Maracuya', t:'fruta', s:20}, {n:'Ciruela', t:'fruta', s:20},
            {n:'Lima', t:'fruta', s:20}, {n:'Fresa-Hierbabuena', t:'fruta', s:20}, {n:'Fresa', t:'fruta', s:20},
            {n:'Guayaba-Hierbabuena', t:'fruta', s:20}, {n:'Guayaba-Fresa', t:'fruta', s:20}, {n:'Pi√±a-Alfalfa', t:'fruta', s:20},
            {n:'Guayaba', t:'fruta', s:20}, {n:'Lima-Albahaca', t:'fruta', s:20}, {n:'Mel√≥n', t:'fruta', s:20},
            {n:'Hierbabuena-Lim√≥n', t:'fruta', s:20}, {n:'Mango', t:'fruta', s:20}, {n:'Lim√≥n-Alfalfa', t:'fruta', s:20},
            {n:'Pi√±a-Naranja', t:'fruta', s:20}, {n:'Lim√≥n-Hierbabuena', t:'fruta', s:20}, {n:'Pi√±a-Hierbabuena', t:'fruta', s:20},
            {n:'Lim√≥n-Chia', t:'fruta', s:20}, {n:'Lim√≥n Pepino', t:'fruta', s:20}, {n:'Pi√±a Naranja H.', t:'fruta', s:20},
            {n:'Mel√≥n C√≠trico', t:'fruta', s:20}, {n:'Lima-Stevia', t:'fruta', s:20},
            {n:'Horchata Fresa', t:'crema', s:15}, {n:'Horchata Arroz', t:'crema', s:15}, {n:'Vainilla', t:'crema', s:15},
            {n:'Mazap√°n', t:'crema', s:15}, {n:'Chai', t:'crema', s:15}, {n:'Taro', t:'crema', s:15},
            {n:'Coco c/ Nuez', t:'crema', s:15}, {n:'Cebada', t:'crema', s:15}, {n:'Kalhua', t:'crema', s:15},
            {n:'Crema Irlandesa', t:'crema', s:15},
            {n:'Paleta-Leche', t:'paleta', s:20, p:30}, {n:'Paleta-Agua', t:'paleta', s:20, p:25},
            {n:'Fresas Con Crema', t:'paleta', s:20, p:25}, {n:'Sandwich', t:'paleta', s:20, p:20},
            {n:'Campana', t:'paleta', s:20, p:20},
            {n:'Frapuchino', t:'paleta', s:999, p:10, hidden: true}
        ];

        let db = JSON.parse(localStorage.getItem(DB_KEY)) || {
            users: { 'zekkqi': { pass: '0802', role: 'ceo' } }, // Usuario por defecto
            cash: 0, soldL: 0, soldP: 0, prodL: 0, prodP: 0,
            currentHistory: [], // Historial del turno actual
            historicalCuts: [], // Cortes agrupados
            inventory: defaultFlavors
        };

        let cart = [];
        let prodMode = 'fruta';
        let invView = 'fruta';
        let CURRENT_USER = null;

        function save() {
            localStorage.setItem(DB_KEY, JSON.stringify(db));
            updateUI();
        }

        // --- AUTENTICACI√ìN Y ROLES ---
        function toggleAuthView(view) {
            document.getElementById('view-login').style.display = view === 'login' ? 'block' : 'none';
            document.getElementById('view-register').style.display = view === 'register' ? 'block' : 'none';
        }

        function attemptRegister() {
            const u = document.getElementById('reg-user').value.toLowerCase().trim();
            const p = document.getElementById('reg-pass').value;
            const r = document.getElementById('reg-role').value;
            const c = document.getElementById('reg-code').value;

            if(!u || !p) return alert("Llena usuario y contrase√±a");
            if(db.users[u]) return alert("Este usuario ya existe");
            if(c !== CREATOR_CODE) return alert("‚ùå C√≥digo de Aprobaci√≥n Incorrecto");

            db.users[u] = { pass: p, role: r };
            save();
            alert(`‚úÖ Usuario ${u} registrado exitosamente como ${r.toUpperCase()}`);
            toggleAuthView('login');
        }

        function attemptLogin() {
            const u = document.getElementById('login-user').value.toLowerCase().trim();
            const p = document.getElementById('login-pass').value;
            const err = document.getElementById('login-error');

            if (db.users[u] && db.users[u].pass === p) {
                CURRENT_USER = { username: u, role: db.users[u].role };
                document.getElementById('user-display').innerText = u.toUpperCase();
                document.getElementById('role-display').innerText = CURRENT_USER.role.toUpperCase();
                document.getElementById('login-overlay').style.display = 'none';
                
                applyRolePermissions(CURRENT_USER.role);
                checkLowStockAlert(); // Alerta de stock al iniciar
                
                document.getElementById('login-user').value = '';
                document.getElementById('login-pass').value = '';
                err.style.display = 'none';
            } else {
                err.style.display = 'block';
            }
        }

        function doLogout() {
            CURRENT_USER = null;
            document.getElementById('login-overlay').style.display = 'flex';
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        }

        function applyRolePermissions(role) {
            // Empleado ve todas las pesta√±as, pero opciones peligrosas se ocultan (.hidden-role)
            const isEmployee = role === 'empleado';
            document.querySelectorAll('.hidden-role').forEach(el => {
                el.style.display = isEmployee ? 'none' : '';
            });
            go('pos', document.getElementById('nav-pos'));
        }

        // --- NAVEGACI√ìN Y ALERTA DE STOCK ---
        function go(screenId, btn) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
            document.getElementById('screen-'+screenId).classList.add('active-screen');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');
            updateUI();
        }

        function checkLowStockAlert() {
            const lowItems = db.inventory.filter(i => !i.hidden && i.t !== 'paleta' && i.s <= 10);
            if(lowItems.length > 0 && CURRENT_USER.role !== 'empleado') {
                let msg = lowItems.map(i => `${i.n} (${i.s} L)`).join('\n');
                alert(`‚ö†Ô∏è ALERTA DE STOCK BAJO (10L o menos):\n\n${msg}\n\nFavor de programar producci√≥n.`);
            }
        }

        // --- VENTA (POS) ---
        function setFilter(type, btn) {
            const grid = document.getElementById('flavors-grid');
            const pc = document.getElementById('price-container');
            const fm = document.getElementById('fixed-price-msg');
            grid.innerHTML = '';
            if(type === 'paleta') { pc.style.display='none'; fm.style.display='block'; }
            else { pc.style.display='block'; fm.style.display='none'; }
            
            db.inventory.sort((a,b)=>a.n.localeCompare(b.n)).forEach(item => {
                if(item.t !== type) return;
                const card = document.createElement('div');
                card.className = 'flavor-card';
                card.onclick = () => addToCart(item);
                
                let cs = 'color:#2c2c2c'; let pd = '';
                if(item.t === 'crema') cs = 'color:#AB47BC';
                else if (item.t === 'fruta') cs = 'color:#BA68C8';
                else if(item.t==='paleta') { cs='color:#6A1B9A'; pd=`<div style="color:#00E676;font-weight:bold;font-size:0.9rem;">$${item.p||10}</div>`; }
                
                let stockDisp = item.hidden ? "‚ôæÔ∏è" : (item.s <= 10 ? `‚ö†Ô∏è ${item.s}` : item.s);
                let badgeStyle = (item.s <= 10 && !item.hidden) ? 'background:#FFEBEE; color:var(--danger);' : '';
                
                card.innerHTML = `<strong style="${cs}">${item.n}</strong><br>${pd}<span class="stock-badge" style="${badgeStyle}">${stockDisp}</span>`;
                grid.appendChild(card);
            });
            if(btn) { document.querySelectorAll('#screen-pos .filter-btn').forEach(b=>b.classList.remove('active')); btn.classList.add('active'); }
        }

        function addToCart(item) {
            if(item.s <= 0) return alert("Sin stock");
            let price = (item.t==='paleta')?(item.p||10):parseFloat(document.getElementById('price-select').value);
            const ex = cart.find(c=>c.name===item.n && c.price===price);
            if(ex) { if(ex.qty>=item.s) return alert("No hay stock"); ex.qty++; }
            else cart.push({name:item.n, price:price, qty:1, type:item.t, isHidden: item.hidden});
            updateCartUI();
        }

        function updateCartUI() {
            const bar = document.getElementById('cart-bar');
            if(cart.length>0) {
                bar.style.display='flex';
                const t = cart.reduce((a,i)=>a+(i.price*i.qty),0);
                const c = cart.reduce((a,i)=>a+i.qty,0);
                document.getElementById('cart-total').innerText=`$${t}`;
                document.getElementById('cart-count').innerText=c;
            } else bar.style.display='none';
        }

        function showCheckout() {
            const list = document.getElementById('checkout-list');
            list.innerHTML = ''; let t = 0;
            cart.forEach((i, idx) => {
                t += i.price*i.qty;
                const u = i.type==='paleta'?'pz':'L';
                list.innerHTML += `<div class="cart-list-item"><div><strong>${i.name}</strong><br>${i.qty}${u} x $${i.price} = $${i.price*i.qty}</div><button class="delete-btn" onclick="removeFromCart(${idx})">‚úï</button></div>`;
            });
            document.getElementById('checkout-total').innerText = `Total: $${t}`;
            document.getElementById('checkout-modal').style.display='flex';
        }

        function removeFromCart(idx) {
            cart.splice(idx,1); updateCartUI();
            if(cart.length===0) document.getElementById('checkout-modal').style.display='none';
            else showCheckout();
        }

        function finishSale() {
            let tc = 0, tl = 0, tp = 0;
            let exactDetails = [];
            
            cart.forEach(c => {
                const i = db.inventory.find(inv=>inv.n===c.name);
                if(i && !i.hidden) i.s -= c.qty;
                tc += c.price*c.qty;
                const u = c.type==='paleta'?'pz':'L';
                exactDetails.push(`${c.qty}${u} de ${c.name}`);
                if(c.type==='paleta') tp += c.qty; else tl += c.qty;
            });

            db.cash += tc; db.soldL += tl; db.soldP += tp;

            // Formatear Detalles de Venta Profundos
            const d = new Date();
            const timeStr = d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            const dateStr = d.toLocaleDateString();
            
            let clientType = "Mixto";
            const selectEl = document.getElementById('price-select');
            if(tl > 0) clientType = selectEl.options[selectEl.selectedIndex].dataset.tipo + ` ($${selectEl.value}xL)`;
            if(tl === 0 && tp > 0) clientType = "Paletas";

            let sumTotal = [];
            if(tl>0) sumTotal.push(`${tl}L`);
            if(tp>0) sumTotal.push(`${tp} Paletas`);

            db.currentHistory.unshift({
                id: Date.now(), type: 'VENTA', date: dateStr, time: timeStr, user: CURRENT_USER.username.toUpperCase(),
                exact: exactDetails.join(', '), sum: sumTotal.join(' y '), money: `+$${tc}`, client: clientType
            });

            cart=[]; document.getElementById('checkout-modal').style.display='none';
            save(); alert("‚úÖ Venta registrada con √©xito");
            const ab = document.querySelector('#screen-pos .filter-btn.active');
            if(ab) ab.click();
        }

        // --- PRODUCCI√ìN ---
        function setProdMode(m) {
            prodMode = m;
            ['fruta','crema','paleta'].forEach(mode => { document.getElementById(`btn-prod-${mode}`).className = 'filter-btn' + (mode===m?' active':''); });
            document.getElementById('prod-subtitle').innerText = m==='paleta'?'Relleno de Paletas':'Producci√≥n de '+m;
            renderProdSelect();
        }

        function renderProdSelect() {
            const s = document.getElementById('prod-flavor');
            s.innerHTML = '';
            db.inventory.sort((a,b)=>a.n.localeCompare(b.n)).forEach(i => {
                if(i.t===prodMode && !i.hidden) s.innerHTML += `<option value="${i.n}">${i.n}</option>`;
            });
        }

        function adjustProd(a) {
            const i = document.getElementById('prod-qty');
            let v = parseInt(i.value)+a; if(v<1) v=1; i.value=v;
        }

        function saveProduction() {
            const n = document.getElementById('prod-flavor').value;
            const q = parseInt(document.getElementById('prod-qty').value);
            const i = db.inventory.find(inv=>inv.n===n);
            if(i) {
                i.s += q;
                if(i.t==='paleta') db.prodP += q; else db.prodL += q;
                const u = i.t==='paleta'?'pz':'L';
                
                const d = new Date();
                db.currentHistory.unshift({
                    id: Date.now(), type: 'PROD', date: d.toLocaleDateString(), time: d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    user: CURRENT_USER.username.toUpperCase(), exact: `${q}${u} de ${n}`, sum: '-', money: '-', client: '-'
                });
                save(); alert("üè≠ Producci√≥n Guardada");
            }
        }

        // --- ADMIN, INVENTARIO VISUAL Y CORTES ---
        function toggleInvView() {
            if(invView==='fruta') invView='crema'; else if(invView==='crema') invView='paleta'; else invView='fruta';
            updateUI();
        }

        function updateUI() {
            document.getElementById('stat-cash').innerText=`$${db.cash}`;
            document.getElementById('stat-sold-l').innerText=`${db.soldL||0} L`;
            document.getElementById('stat-sold-p').innerText=`${db.soldP||0} Pz`;
            document.getElementById('stat-prod-l').innerText=`${db.prodL||0} L`;
            document.getElementById('stat-prod-p').innerText=`${db.prodP||0} Pz`;
            document.getElementById('inv-title').innerText='Inventario de '+invView.toUpperCase();
            
            // Render de Barras de Inventario
            const invC = document.getElementById('inv-container');
            invC.innerHTML = '';
            
            db.inventory.sort((a,b)=>a.n.localeCompare(b.n)).forEach(i => {
                if(i.t===invView && !i.hidden) {
                    let pct = Math.min((i.s / 100) * 100, 100); // Tope visual en 100%
                    let barColor = i.s <= 10 ? 'var(--danger)' : (i.t==='paleta' ? 'var(--primary)' : 'var(--primary-light)');
                    let warningTag = i.s <= 10 ? '<span style="color:red; font-size:0.8rem;">(Stock Bajo)</span>' : '';
                    let unit = i.t === 'paleta' ? 'pz' : 'L';
                    
                    invC.innerHTML += `
                    <div class="inv-row">
                        <div class="inv-info"><span>${i.n} ${warningTag}</span><span>${i.s} ${unit}</span></div>
                        <div class="progress-bg"><div class="progress-fill" style="width:${pct}%; background:${barColor};"></div></div>
                    </div>`;
                }
            });

            renderHistory();
            renderHistoricalCuts();
            renderProdSelect(); updateCartUI();
        }

        // --- HISTORIAL PROFUNDO ---
        function renderHistory() {
            const hc = document.getElementById('hist-current-container');
            hc.innerHTML = '';
            if(db.currentHistory.length === 0) hc.innerHTML = '<p style="text-align:center; color:#999; font-size:0.9rem;">Sin movimientos en este turno.</p>';
            
            db.currentHistory.forEach(h => {
                let badge = h.type === 'VENTA' ? 'badge-venta' : 'badge-prod';
                let moneyStr = h.money !== '-' ? `<span style="color:var(--accent); font-weight:bold; font-size:1.1rem;">${h.money}</span>` : '';
                
                hc.innerHTML += `
                <div class="history-card">
                    <div class="hist-header">
                        <span><span class="hist-badge ${badge}">${h.type}</span> üïí ${h.time}</span>
                        <span>üë§ ${h.user}</span>
                    </div>
                    <div style="font-weight:bold; font-size:0.95rem;">${h.sum} ${moneyStr}</div>
                    <div style="font-size:0.85rem; color:#444; margin-top:5px;">Detalle: ${h.exact}</div>
                    ${h.client !== '-' ? `<div style="font-size:0.8rem; color:#888; margin-top:5px;">üìã Cliente: ${h.client}</div>` : ''}
                </div>`;
            });
        }

        // --- CORTE DE CAJA (TURNOS) ---
        function closeDay() {
            if(!confirm("‚ö†Ô∏è ¬øEst√°s seguro de hacer el Corte de Caja?\nEsto cerrar√° el turno actual y guardar√° los reportes en el historial.")) return;
            
            const d = new Date();
            const dateStr = d.toLocaleDateString('es-MX', {day: 'numeric', month: 'long', year: 'numeric'});
            
            const cutObj = {
                id: Date.now(),
                dateGroup: `Cortes ${dateStr}`,
                time: d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                stats: { cash: db.cash, sl: db.soldL, sp: db.soldP, pl: db.prodL, pp: db.prodP },
                movements: [...db.currentHistory]
            };

            db.historicalCuts.unshift(cutObj); // Guardar corte
            
            // Resetear Turno Actual
            db.currentHistory = [];
            db.cash=0; db.soldL=0; db.soldP=0; db.prodL=0; db.prodP=0; 
            save(); alert("üîí Corte de caja realizado exitosamente.");
        }

        function renderHistoricalCuts() {
            const container = document.getElementById('hist-cuts-container');
            container.innerHTML = '';
            
            // Agrupar por d√≠a
            const groups = {};
            db.historicalCuts.forEach(cut => {
                if(!groups[cut.dateGroup]) groups[cut.dateGroup] = [];
                groups[cut.dateGroup].push(cut);
            });

            for(const date in groups) {
                let cutButtons = groups[date].map(c => 
                    `<button class="btn btn-sm" style="background:#f3e5f5; color:var(--primary); margin-top:5px; margin-right:5px;" onclick="openCutDetail(${c.id})">üïí Corte ${c.time}</button>`
                ).join('');

                container.innerHTML += `
                <div class="hist-cut-group">
                    <div class="hist-cut-title">üìÖ ${date}</div>
                    <div style="display:flex; flex-wrap:wrap;">${cutButtons}</div>
                </div>`;
            }
        }


        function clearHistory() {
            if(confirm("üõë PELIGRO: ¬øEst√°s seguro de BORRAR TODOS los cortes hist√≥ricos y empezar desde cero?")) {
                if(confirm("‚ö†Ô∏è CONFIRMACI√ìN FINAL. Esta acci√≥n no se puede deshacer.")) {
                    db.historicalCuts = []; db.currentHistory = []; save(); alert("Historial completamente eliminado.");
                }
            }
        }
        
        function openCutDetail(id) {
            const cut = db.historicalCuts.find(c => c.id === id);
            if(!cut) return;

            document.getElementById('cut-detail-title').innerText = `Reporte: ${cut.time}`;
            document.getElementById('cut-detail-stats').innerHTML = `
                <strong>Total en Caja:</strong> <span style="color:var(--accent); font-size:1.1rem; font-weight:bold;">$${cut.stats.cash}</span><br>
                <strong>Ventas:</strong> ${cut.stats.sl}L de Agua | ${cut.stats.sp} Paletas<br>
                <strong>Producci√≥n:</strong> ${cut.stats.pl}L de Agua | ${cut.stats.pp} Paletas
            `;

            const listC = document.getElementById('cut-detail-list');
            listC.innerHTML = cut.movements.map(h => `
                <div style="border-bottom:1px solid #ddd; padding:8px 0;">
                    <strong style="color:var(--primary);">${h.type} (${h.time}) - üë§ ${h.user}</strong><br>
                    ${h.sum} ${h.money !== '-' ? `<b>(${h.money})</b>` : ''}<br>
                    <span style="color:#666;">${h.exact}</span>
                </div>
            `).join('') || '<p>No hubo movimientos en este turno.</p>';

            document.getElementById('cut-detail-modal').style.display = 'flex';
        }
            
        function downloadExcel() {
            let csv = "\uFEFFFecha,Hora,Usuario,Tipo,Movimiento,Suma,Ingreso,Cliente\n";
            db.historicalCuts.forEach(cut => {
                cut.movements.forEach(h => {
                    let cleanDet = h.exact.replace(/,/g, ' '); 
                    csv += `${h.date},${h.time},${h.user},${h.type},"${cleanDet}",${h.sum},${h.money},${h.client}\n`;
                });
            });
            const blob = new Blob([csv], {type: 'text/csv;charset=utf-8;'});
            const a = document.createElement('a');
            a.href = window.URL.createObjectURL(blob); 
            a.download = `Reporte_Jalisciense_${new Date().toLocaleDateString().replace(/\//g,'-')}.csv`;
            a.click();
        }

        // --- FUNCIONES DE AJUSTES E INVENTARIO (MODALES) ---
        function openSettings() { document.getElementById('settings-modal').style.display='flex'; }
        function closeSettings() { document.getElementById('settings-modal').style.display='none'; }
        
        function showAddFlavor() { document.getElementById('new-flavor-name').value = ''; document.getElementById('new-flavor-stock').value = ''; document.getElementById('add-flavor-modal').style.display='flex'; }
        function saveNewFlavor() {
            const n = document.getElementById('new-flavor-name').value.trim(); const t = document.getElementById('new-flavor-type').value; const s = parseInt(document.getElementById('new-flavor-stock').value) || 0;
            if(!n) return alert("Ingresa un nombre."); if(db.inventory.find(i => i.n.toLowerCase() === n.toLowerCase())) return alert("Ese sabor ya existe.");
            db.inventory.push({n: n, t: t, s: s}); save(); document.getElementById('add-flavor-modal').style.display='none'; alert("‚úÖ Sabor registrado");
        }

        function showAddPaleta() { document.getElementById('new-paleta-name').value = ''; document.getElementById('new-paleta-price').value = ''; document.getElementById('new-paleta-stock').value = ''; document.getElementById('add-paleta-modal').style.display='flex'; }
        function saveNewPaleta() {
            const n = document.getElementById('new-paleta-name').value.trim(); const p = parseFloat(document.getElementById('new-paleta-price').value) || 0; const s = parseInt(document.getElementById('new-paleta-stock').value) || 0;
            if(!n) return alert("Ingresa un nombre."); if(db.inventory.find(i => i.n.toLowerCase() === n.toLowerCase())) return alert("Esta paleta ya existe.");
            db.inventory.push({n: n, t: 'paleta', s: s, p: p}); save(); document.getElementById('add-paleta-modal').style.display='none'; alert("‚úÖ Paleta registrada");
        }

        function showEditFlavors() { renderEditList(); document.getElementById('edit-flavors-modal').style.display='flex'; }
        function renderEditList() {
            const c = document.getElementById('edit-list-container'); c.innerHTML = '';
            db.inventory.sort((a,b)=>a.n.localeCompare(b.n)).forEach((item, index) => {
                if(item.hidden) return; 
                let tOps = item.t==='paleta' ? `<option value="paleta" selected>Paleta</option>` : `<option value="fruta" ${item.t==='fruta'?'selected':''}>Fruta</option><option value="crema" ${item.t==='crema'?'selected':''}>Crema</option>`;
                let pHtml = item.t==='paleta' ? `<input type="number" id="e-p-${index}" value="${item.p}" style="width:50px; padding:5px; border:1px solid #ccc; border-radius:5px;">` : ``;
                c.innerHTML += `<div style="background:#f9f9f9; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd;">
                    <div style="display:flex; gap:5px; margin-bottom:5px;"><input type="text" id="e-n-${index}" value="${item.n}" style="flex:1; padding:5px; border-radius:5px; font-weight:bold;"><select id="e-t-${index}" style="padding:5px; border-radius:5px;">${tOps}</select></div>
                    <div style="display:flex; gap:5px; align-items:center; justify-content:flex-end;">${pHtml} <span style="font-size:0.8rem;">Stock:</span><input type="number" id="e-s-${index}" value="${item.s}" style="width:55px; padding:5px; border-radius:5px;">
                    <button class="btn-success" style="padding:5px 10px; border-radius:5px; border:none;" onclick="saveEdit(${index})">üíæ</button><button class="btn-danger" style="padding:5px 10px; border-radius:5px; border:none;" onclick="deleteItem(${index})">üóëÔ∏è</button></div></div>`;
            });
        }
        function saveEdit(idx) { const i = db.inventory[idx]; i.n = document.getElementById(`e-n-${idx}`).value; i.t = document.getElementById(`e-t-${idx}`).value; i.s = parseInt(document.getElementById(`e-s-${idx}`).value) || 0; if(i.t==='paleta') i.p = parseFloat(document.getElementById(`e-p-${idx}`).value) || 0; save(); alert("‚úÖ Cambios guardados."); const ab = document.querySelector('#screen-pos .filter-btn.active'); if(ab) ab.click(); }
        function deleteItem(idx) { if(confirm("‚ö†Ô∏è ¬øEliminar este producto permanentemente?")) { db.inventory.splice(idx, 1); save(); renderEditList(); const ab = document.querySelector('#screen-pos .filter-btn.active'); if(ab) ab.click(); } }

        // Inicializaci√≥n
        const firstBtn = document.querySelector('.filter-btn');
        if(firstBtn) setFilter('fruta', firstBtn);
    </script>
</body>
</html>
